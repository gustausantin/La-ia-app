# üìä **BASE DE DATOS MASTER REFERENCE - LA-IA APP**

> **ARCHIVO √öNICO Y DEFINITIVO** - Toda la informaci√≥n de Supabase en un solo lugar

**üìÖ √öltima actualizaci√≥n:** 28 Enero 2025  
**üéØ Estado:** Confirmado con datos reales de Supabase  
**üìã Total tablas:** 23 tablas

---

## üéØ **RESUMEN EJECUTIVO**

### **üìä ESTAD√çSTICAS:**
- **23 TABLAS TOTALES** ‚úÖ
- **17 Tablas principales** + **6 Tablas de IA avanzada**
- **Todas con UUID como PRIMARY KEY**
- **Relaciones por `restaurant_id`**
- **Timestamps autom√°ticos** en la mayor√≠a

### **üîó RELACI√ìN CENTRAL:**
**`restaurants` ‚Üí Es la tabla PRINCIPAL**  
**`user_restaurant_mapping` ‚Üí Controla acceso**  
**Todas las dem√°s tablas ‚Üí Se relacionan por `restaurant_id`**

---

## üè¢ **TABLA PRINCIPAL - RESTAURANTS**

### **üè¢ `restaurants`** (Tabla central del sistema)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
name              VARCHAR NOT NULL
email             VARCHAR
phone             VARCHAR
address           TEXT
city              VARCHAR
country           VARCHAR DEFAULT 'Espa√±a'
postal_code       VARCHAR
cuisine_type      VARCHAR
plan              VARCHAR DEFAULT 'trial'
active            BOOLEAN DEFAULT true
settings          JSONB DEFAULT '{}'
agent_config      JSONB DEFAULT '{}'
business_hours    JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
owner_id          UUID
```
**üéØ Funci√≥n:** Tabla central - todos los datos giran alrededor de esta tabla

---

## üë• **GESTI√ìN DE USUARIOS**

### **üë• `user_restaurant_mapping`** (Control de acceso cr√≠tico)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
auth_user_id      UUID NOT NULL ‚Üí auth.users(id)
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
role              VARCHAR DEFAULT 'staff'
permissions       JSONB DEFAULT '{}'
active            BOOLEAN DEFAULT true
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Control de acceso multi-tenant + roles

### **üë§ `profiles`** (Perfiles extendidos de usuarios)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
auth_user_id      UUID NOT NULL ‚Üí auth.users(id)
email             VARCHAR NOT NULL
full_name         VARCHAR
avatar_url        TEXT
restaurant_name   VARCHAR
phone             VARCHAR
role              VARCHAR DEFAULT 'owner'
preferences       JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Datos extendidos de usuarios

### **üë®‚Äçüíº `staff`** (Gesti√≥n de personal)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
auth_user_id      UUID ‚Üí auth.users(id)
name              VARCHAR NOT NULL
email             VARCHAR
phone             VARCHAR
role              VARCHAR NOT NULL
active            BOOLEAN DEFAULT true
schedule          JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Control de empleados del restaurante

---

## üë§ **GESTI√ìN DE CLIENTES**

### **üë§ `customers`** (Base de datos de clientes)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
name              VARCHAR NOT NULL
email             VARCHAR
phone             VARCHAR
preferences       JSONB DEFAULT '{}'
tags              TEXT[] ARRAY
notes             TEXT
total_visits      INTEGER DEFAULT 0
total_spent       NUMERIC DEFAULT 0
last_visit        TIMESTAMP WITH TIME ZONE
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** CRM completo con historial y analytics

---

## üìÖ **GESTI√ìN DE RESERVAS**

### **üìÖ `reservations`** (Sistema principal de reservas)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
customer_id       UUID ‚Üí customers(id)
customer_name     VARCHAR NOT NULL
customer_email    VARCHAR
customer_phone    VARCHAR
reservation_date  DATE NOT NULL
reservation_time  TIME NOT NULL
party_size        INTEGER NOT NULL
status            VARCHAR DEFAULT 'confirmed'
table_number      VARCHAR
special_requests  TEXT
source            VARCHAR DEFAULT 'web'
notes             TEXT
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
channel           VARCHAR DEFAULT 'web'
date              DATE
time              TIME
table_id          UUID ‚Üí tables(id)
```
**üéØ Funci√≥n:** Gesti√≥n completa de reservas

### **üìã `reservations_with_customer`** (Vista combinada)
```sql
id                         UUID
restaurant_id              UUID
reservation_date           DATE
reservation_time           TIME
party_size                 INTEGER
status                     VARCHAR
notes                      TEXT
source                     VARCHAR
channel                    VARCHAR
created_at                 TIMESTAMP WITH TIME ZONE
updated_at                 TIMESTAMP WITH TIME ZONE
customer_id                UUID
customer_name              VARCHAR
customer_email             VARCHAR
customer_phone             VARCHAR
linked_customer_id         UUID
linked_customer_name       VARCHAR
linked_customer_email      VARCHAR
linked_customer_phone      VARCHAR
linked_customer_notes      TEXT
```
**üéØ Funci√≥n:** Vista que combina reservas con datos de clientes

---

## ü™ë **GESTI√ìN DE MESAS**

### **ü™ë `tables`** (Mesas f√≠sicas del restaurante)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
table_number      TEXT NOT NULL
capacity          INTEGER NOT NULL
location          TEXT
status            TEXT DEFAULT 'available'
position_x        DOUBLE PRECISION
position_y        DOUBLE PRECISION
notes             TEXT
is_active         BOOLEAN DEFAULT true
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
zone              VARCHAR DEFAULT 'main'
name              VARCHAR
```
**üéØ Funci√≥n:** Control f√≠sico de mesas y distribuci√≥n

---

## üí¨ **SISTEMA DE COMUNICACI√ìN**

### **üó®Ô∏è `conversations`** (Conversaciones con clientes)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
customer_id       UUID ‚Üí customers(id)
customer_name     TEXT NOT NULL
customer_phone    TEXT
customer_email    TEXT
subject           TEXT
status            TEXT DEFAULT 'open'
priority          TEXT DEFAULT 'normal'
assigned_to       UUID ‚Üí staff(id)
channel           TEXT DEFAULT 'app'
tags              TEXT[] ARRAY DEFAULT ARRAY[]
metadata          JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Gesti√≥n de conversaciones multicanal

### **üí¨ `messages`** (Mensajes individuales)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
customer_phone    VARCHAR
customer_name     VARCHAR
message_text      TEXT NOT NULL
message_type      VARCHAR DEFAULT 'text'
direction         VARCHAR NOT NULL
channel           VARCHAR NOT NULL
status            VARCHAR DEFAULT 'sent'
metadata          JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Mensajes del sistema de comunicaci√≥n

### **üìù `message_templates`** (Plantillas de mensajes)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
name              TEXT NOT NULL
category          TEXT NOT NULL
subject           TEXT
content           TEXT NOT NULL
variables         TEXT[] ARRAY DEFAULT ARRAY[]
channel           TEXT NOT NULL
is_active         BOOLEAN DEFAULT true
usage_count       INTEGER DEFAULT 0
created_by        UUID ‚Üí staff(id)
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Plantillas predefinidas para comunicaci√≥n

---

## üîî **NOTIFICACIONES**

### **üîî `notifications`** (Sistema de notificaciones)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
user_id           UUID ‚Üí auth.users(id)
title             TEXT NOT NULL
message           TEXT NOT NULL
type              TEXT NOT NULL
priority          TEXT DEFAULT 'normal'
is_read           BOOLEAN DEFAULT false
action_url        TEXT
metadata          JSONB DEFAULT '{}'
expires_at        TIMESTAMP WITH TIME ZONE
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
read_at           TIMESTAMP WITH TIME ZONE
```
**üéØ Funci√≥n:** Sistema de notificaciones push

---

## üì¶ **GESTI√ìN DE INVENTARIO**

### **üìã `inventory`** (Inventario principal)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
name              VARCHAR NOT NULL
category          VARCHAR
quantity          NUMERIC DEFAULT 0
unit              VARCHAR
min_threshold     NUMERIC
cost_per_unit     NUMERIC
supplier          VARCHAR
last_updated      TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Control b√°sico de stock

### **üì¶ `inventory_items`** (Items espec√≠ficos de inventario)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
name              TEXT NOT NULL
category          TEXT NOT NULL
description       TEXT
unit              TEXT NOT NULL
current_stock     NUMERIC DEFAULT 0
minimum_stock     NUMERIC DEFAULT 0
maximum_stock     NUMERIC
cost_per_unit     NUMERIC DEFAULT 0
supplier          TEXT
supplier_contact  JSONB DEFAULT '{}'
barcode           TEXT
location          TEXT
expiration_date   DATE
last_restocked    TIMESTAMP WITH TIME ZONE
status            TEXT DEFAULT 'active'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Control detallado de inventario con c√≥digos de barras

---

## üìä **ANALYTICS Y M√âTRICAS**

### **üìä `analytics`** (M√©tricas principales)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
type              VARCHAR NOT NULL
date              DATE NOT NULL
value             NUMERIC NOT NULL
metadata          JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** M√©tricas y KPIs principales

### **üìà `analytics_historical`** (Datos hist√≥ricos)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
metric_type       TEXT NOT NULL
metric_name       TEXT NOT NULL
metric_value      NUMERIC NOT NULL
dimension1        TEXT
dimension1_value  TEXT
dimension2        TEXT
dimension2_value  TEXT
period_type       TEXT NOT NULL
period_start      TIMESTAMP WITH TIME ZONE NOT NULL
period_end        TIMESTAMP WITH TIME ZONE NOT NULL
metadata          JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Datos hist√≥ricos agregados para an√°lisis

### **üìÖ `daily_metrics`** (M√©tricas diarias)
```sql
id                           UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id                UUID NOT NULL ‚Üí restaurants(id)
date                         DATE NOT NULL
total_reservations           INTEGER DEFAULT 0
confirmed_reservations       INTEGER DEFAULT 0
cancelled_reservations       INTEGER DEFAULT 0
no_shows                     INTEGER DEFAULT 0
walk_ins                     INTEGER DEFAULT 0
total_customers              INTEGER DEFAULT 0
new_customers                INTEGER DEFAULT 0
returning_customers          INTEGER DEFAULT 0
table_utilization_rate       NUMERIC DEFAULT 0
average_party_size           NUMERIC DEFAULT 0
peak_hour_start              TIME
peak_hour_end                TIME
total_revenue                NUMERIC DEFAULT 0
average_spend_per_customer   NUMERIC DEFAULT 0
customer_satisfaction_score  NUMERIC
staff_efficiency_score       NUMERIC
notes                        TEXT
created_at                   TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at                   TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Resumen autom√°tico diario

---

## ‚öôÔ∏è **CONFIGURACI√ìN**

### **‚öôÔ∏è `restaurant_settings`** (Configuraci√≥n del restaurante)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID NOT NULL ‚Üí restaurants(id)
category          TEXT NOT NULL
setting_key       TEXT NOT NULL
setting_value     JSONB NOT NULL
description       TEXT
is_sensitive      BOOLEAN DEFAULT false
created_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
updated_at        TIMESTAMP WITH TIME ZONE DEFAULT timezone('utc', now())
```
**üéØ Funci√≥n:** Configuraci√≥n espec√≠fica por categor√≠as

### **üè™ `restaurant_business_config`** (Configuraci√≥n de negocio)
```sql
id                              UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id                   UUID ‚Üí restaurants(id)
avg_ticket_price                NUMERIC DEFAULT 35.00
monthly_revenue                 NUMERIC
staff_cost_monthly              NUMERIC DEFAULT 1800.00
current_reservations_monthly    INTEGER DEFAULT 0
target_growth_percentage        NUMERIC DEFAULT 15.00
ai_system_cost                  NUMERIC DEFAULT 199.00
ai_expected_improvement         NUMERIC DEFAULT 15.00
operating_hours_daily           INTEGER DEFAULT 12
peak_hours_percentage           NUMERIC DEFAULT 30.00
manual_response_time_minutes    NUMERIC DEFAULT 5.00
configured_by                   VARCHAR
last_updated                    TIMESTAMP WITH TIME ZONE DEFAULT now()
created_at                      TIMESTAMP WITH TIME ZONE DEFAULT now()
```
**üéØ Funci√≥n:** Configuraci√≥n de m√©tricas de negocio para IA

---

## ü§ñ **SISTEMA DE IA AVANZADA**

### **ü§ñ `agent_conversations`** (Conversaciones del agente IA)
```sql
id                    UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id         UUID ‚Üí restaurants(id)
status                VARCHAR DEFAULT 'active'
customer_phone        VARCHAR
customer_name         VARCHAR
channel               VARCHAR
started_at            TIMESTAMP WITH TIME ZONE DEFAULT now()
ended_at              TIMESTAMP WITH TIME ZONE
messages_count        INTEGER DEFAULT 0
satisfaction_score    INTEGER
booking_created       BOOLEAN DEFAULT false
created_at            TIMESTAMP WITH TIME ZONE DEFAULT now()
updated_at            TIMESTAMP WITH TIME ZONE DEFAULT now()
```
**üéØ Funci√≥n:** Gesti√≥n de conversaciones del agente IA

### **üß† `agent_insights`** (Insights generados por IA)
```sql
id                UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id     UUID ‚Üí restaurants(id)
type              VARCHAR
title             VARCHAR
description       TEXT
priority          VARCHAR DEFAULT 'medium'
action_required   BOOLEAN DEFAULT false
data              JSONB DEFAULT '{}'
created_at        TIMESTAMP WITH TIME ZONE DEFAULT now()
resolved_at       TIMESTAMP WITH TIME ZONE
```
**üéØ Funci√≥n:** Insights autom√°ticos generados por IA

### **üìä `agent_metrics`** (M√©tricas del agente IA)
```sql
id                     UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id          UUID ‚Üí restaurants(id)
date                   DATE DEFAULT CURRENT_DATE
total_conversations    INTEGER DEFAULT 0
successful_bookings    INTEGER DEFAULT 0
avg_response_time      DOUBLE PRECISION DEFAULT 0
conversion_rate        DOUBLE PRECISION DEFAULT 0
customer_satisfaction  DOUBLE PRECISION DEFAULT 0
channel_breakdown      JSONB DEFAULT '{}'
created_at             TIMESTAMP WITH TIME ZONE DEFAULT now()
updated_at             TIMESTAMP WITH TIME ZONE DEFAULT now()
```
**üéØ Funci√≥n:** M√©tricas de performance del agente IA

### **üìà `channel_performance`** (Performance por canal)
```sql
id                     UUID PRIMARY KEY DEFAULT gen_random_uuid()
restaurant_id          UUID ‚Üí restaurants(id)
channel                VARCHAR
date                   DATE DEFAULT CURRENT_DATE
conversations          INTEGER DEFAULT 0
bookings               INTEGER DEFAULT 0
conversion_rate        DOUBLE PRECISION DEFAULT 0
avg_response_time      DOUBLE PRECISION DEFAULT 0
customer_satisfaction  DOUBLE PRECISION DEFAULT 0
created_at             TIMESTAMP WITH TIME ZONE DEFAULT now()
```
**üéØ Funci√≥n:** Analytics por canal de comunicaci√≥n

### **üí¨ `conversation_analytics`** (Analytics de conversaciones)
```sql
id                    UUID PRIMARY KEY DEFAULT gen_random_uuid()
conversation_id       UUID ‚Üí conversations(id)
restaurant_id         UUID ‚Üí restaurants(id)
total_messages        INTEGER DEFAULT 0
ai_messages           INTEGER DEFAULT 0
human_messages        INTEGER DEFAULT 0
avg_response_time     DOUBLE PRECISION DEFAULT 0
intent_detected       VARCHAR
sentiment_score       DOUBLE PRECISION DEFAULT 0
topics                JSONB DEFAULT '[]'
created_at            TIMESTAMP WITH TIME ZONE DEFAULT now()
```
**üéØ Funci√≥n:** Analytics avanzados de conversaciones con IA

---

## üîß **TRIGGERS ACTIVOS**

### **üö® TRIGGERS `handle_updated_at`:**
- **conversations** ‚Üí Actualiza `updated_at` en UPDATE
- **daily_metrics** ‚Üí Actualiza `updated_at` en UPDATE
- **inventory_items** ‚Üí Actualiza `updated_at` en UPDATE
- **message_templates** ‚Üí Actualiza `updated_at` en UPDATE
- **restaurant_settings** ‚Üí Actualiza `updated_at` en UPDATE
- **tables** ‚Üí Actualiza `updated_at` en UPDATE

---

## üîó **RELACIONES PRINCIPALES**

### **üéØ FLUJO DE DATOS:**
```
auth.users (Supabase Auth)
    ‚Üì
user_restaurant_mapping (Control acceso)
    ‚Üì
restaurants (Tabla central)
    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ TODAS LAS DEM√ÅS TABLAS                  ‚îÇ
‚îÇ (relacionadas por restaurant_id)        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### **üîó FOREIGN KEYS PRINCIPALES:**
- **Todas las tablas** ‚Üí `restaurant_id` ‚Üí `restaurants(id)`
- **user_restaurant_mapping** ‚Üí `auth_user_id` ‚Üí `auth.users(id)`
- **profiles** ‚Üí `auth_user_id` ‚Üí `auth.users(id)`
- **staff** ‚Üí `auth_user_id` ‚Üí `auth.users(id)`
- **reservations** ‚Üí `customer_id` ‚Üí `customers(id)`
- **reservations** ‚Üí `table_id` ‚Üí `tables(id)`
- **conversations** ‚Üí `customer_id` ‚Üí `customers(id)`
- **conversation_analytics** ‚Üí `conversation_id` ‚Üí `conversations(id)`

---

## üìù **NOTAS IMPORTANTES**

### **üö® ESTADO DE SEGURIDAD:**
- **La mayor√≠a de tablas tienen RLS habilitado**
- **Algunas tablas de IA est√°n "Unrestricted"** (pendiente configurar)
- **Pol√≠ticas basadas en `restaurant_id`**

### **üéØ CONVENCIONES:**
- **UUID como PRIMARY KEY** en todas las tablas
- **`restaurant_id`** como foreign key universal
- **JSONB** para datos flexibles (settings, metadata, etc.)
- **Timestamps UTC** autom√°ticos
- **Arrays** para tags y variables

### **üîß MANTENIMIENTO:**
- **Triggers autom√°ticos** para `updated_at`
- **Valores por defecto** bien definidos
- **Estructura normalizada** pero flexible

---

## üéØ **PARA DESARROLLADORES**

### **‚úÖ USAR ESTE ARCHIVO PARA:**
- **Conocer EXACTAMENTE** qu√© columnas existen
- **Entender las relaciones** entre tablas
- **Hacer consultas SQL** correctas
- **Crear scripts** que funcionen
- **No m√°s errores** de "columna no existe"

### **üìã ESTE ES EL √öNICO ARCHIVO DE REFERENCIA**
- **No hay otros archivos** de esquema
- **Esta es la fuente de verdad**
- **Actualizado con datos reales** de Supabase
- **23 tablas confirmadas**

---

**üéâ ¬°BASE DE DATOS COMPLETAMENTE DOCUMENTADA!** ‚ú®
